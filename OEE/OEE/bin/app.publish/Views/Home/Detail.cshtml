
@{
    ViewBag.Title = "Detail";
}
@using OEE.Models;
@model List<spLCDFull_Result>
<script src="~/Scripts/highcharts/7.1.2/highcharts.js"></script>
<script src="~/Scripts/highcharts/7.1.2/modules/exporting.js"></script>
<script src="~/Scripts/highcharts/7.1.2/modules/export-data.js"></script>
<script src="~/Scripts/highcharts/7.1.2/modules/accessibility.js"></script>
<script src="~/Scripts/jquery-3.4.1.min.js"></script>
@{
    string AutoRefresh = System.Configuration.ConfigurationManager.AppSettings["pagerefresh"];
    this.Response.AppendHeader("Refresh", AutoRefresh);
}
<style>

    .table tbody tr td {
        width: auto;
        padding: 0px;
    }

    .table1 {
        width: 100%;
        height: 100vh;
    }
    #container {
        height: 95vh;
        width: 100%;
    }
    #container tspan
    {
        font-size:15px;
    }
</style>
@foreach (var item in Model)
{
    try
    {
        string strMC = item.COTMAUCHUNG;
        string[] arrListStrMC = strMC.Split(';');
        int RMC = Convert.ToInt32(arrListStrMC[0]);
        int GMC = Convert.ToInt32(arrListStrMC[1]);
        int BMC = Convert.ToInt32(arrListStrMC[2]);

        <body style="margin:10px;padding:0;background-color:rgb(@RMC,@GMC,@BMC)" onload="startTime()">
            <table class="table1 table table-bordered table-hover" style="background-color:rgb(255 255 255);table-layout: fixed">
                <tr>
                    <td colspan="2">
                        @foreach (var item1 in Model)
                        {
                            string strshift = item1.COT0DD;
                            string[] arrListStrshift = strshift.Split(';');
                            int Rshift = Convert.ToInt32(arrListStrshift[0]);
                            int Gshift = Convert.ToInt32(arrListStrshift[1]);
                            int Bshift = Convert.ToInt32(arrListStrshift[2]);
                            string fontchushift = arrListStrshift[3];
                            string sizechushift = arrListStrshift[4];

                            string indamshift = "normal";
                            string nghienshift = "normal";
                            string cangiuashift = "normal";

                            if (arrListStrshift[5] == "T")
                            {
                                indamshift = "bold";
                            }

                            if (arrListStrshift[6] == "T")
                            {
                                nghienshift = "italic";
                            }
                            if (arrListStrshift[7] == "T")
                            {
                                cangiuashift = "center";
                            }
                            <div>
                                <a href="https://logwork.com/current-time-in-ho-chi-minh-city-vietnam-ho-chi-minh" class="clock-widget-text" data-timezone="Asia/Phnom_Penh" data-language="vi"> </a>
                            </div>
                            <div style="display:inline">
                                <label style="margin-left:30px;text-align:left;font-family:@fontchushift;font-weight:@indamshift;font-style:@nghienshift;font-size:@sizechushift;color:rgb(@Rshift,@Gshift,@Bshift)">@String.Format("{0:dd/MM/yyyy}", @DateTime.Now)</label>
                                <label style="text-align:@cangiuashift;font-family:@fontchushift;font-weight:@indamshift;font-style:@nghienshift;font-size:@sizechushift;color:rgb(@Rshift,@Gshift,@Bshift);margin:auto">@item1.COT0</label>
                                <label style="margin-right:30px;float:right;font-family:@fontchushift;font-weight:@indamshift;font-style:@nghienshift;font-size:@sizechushift;color:rgb(@Rshift,@Gshift,@Bshift)" id="gioht"></label>
                            </div>
                            break;
                        }
                    </td>
                </tr>
                <tr>
                    <td>
                        <div id="container"></div>
                    </td>
                    <td style="padding:0;border: 1px solid white">
                        @foreach (var item2 in Model)
                        {
                            <div class="col-lg-3 col-sm-3" style="padding:3px;margin-bottom:-20px">
                                @{
                                    #region COTMAUNEN
                                    string strMN = item2.COTMAUNEN;
                                    string[] arrListStrMN = strMN.Split(';');
                                    int RMN = Convert.ToInt32(arrListStrMN[0]);
                                    int GMN = Convert.ToInt32(arrListStrMN[1]);
                                    int BMN = Convert.ToInt32(arrListStrMN[2]);
                                    #endregion

                                    #region COT1DD

                                    string str1 = item2.COT1DD;
                                    string[] arrListStr1 = str1.Split(';');
                                    int R1 = Convert.ToInt32(arrListStr1[0]);
                                    int G1 = Convert.ToInt32(arrListStr1[1]);
                                    int B1 = Convert.ToInt32(arrListStr1[2]);
                                    string fontchu = arrListStr1[3];
                                    string sizechu = arrListStr1[4];

                                    string indam = "normal";
                                    string nghien = "normal";
                                    string cangiua = "normal";

                                    if (arrListStr1[5] == "T")
                                    {
                                        indam = "bold";
                                    }

                                    if (arrListStr1[6] == "T")
                                    {
                                        nghien = "italic";
                                    }
                                    if (arrListStr1[7] == "T")
                                    {
                                        cangiua = "center";
                                    }
                                    #endregion

                                    #region COT2DD
                                    string str2 = item2.COT2DD;
                                    string[] arrListStr2 = str2.Split(';');
                                    int R2 = Convert.ToInt32(arrListStr2[0]);
                                    int G2 = Convert.ToInt32(arrListStr2[1]);
                                    int B2 = Convert.ToInt32(arrListStr2[2]);

                                    string fontchu2 = arrListStr2[3];
                                    string sizechu2 = arrListStr2[4];

                                    string indam2 = "normal";
                                    string nghien2 = "normal";
                                    string cangiua2 = "normal";

                                    if (arrListStr2[5] == "T")
                                    {
                                        indam2 = "bold";
                                    }

                                    if (arrListStr2[6] == "T")
                                    {
                                        nghien2 = "italic";
                                    }
                                    if (arrListStr2[7] == "T")
                                    {
                                        cangiua2 = "center";
                                    }
                                    #endregion

                                    #region COT3DD
                                    string str3 = item2.COT3DD;
                                    string[] arrListStr3 = str3.Split(';');
                                    int R3 = Convert.ToInt32(arrListStr3[0]);
                                    int G3 = Convert.ToInt32(arrListStr3[1]);
                                    int B3 = Convert.ToInt32(arrListStr3[2]);

                                    string fontchu3 = arrListStr3[3];
                                    string sizechu3 = arrListStr3[4];

                                    string indam3 = "normal";
                                    string nghien3 = "normal";
                                    string cangiua3 = "normal";

                                    if (arrListStr3[5] == "T")
                                    {
                                        indam3 = "bold";
                                    }

                                    if (arrListStr3[6] == "T")
                                    {
                                        nghien3 = "italic";
                                    }
                                    if (arrListStr3[7] == "T")
                                    {
                                        cangiua3 = "center";
                                    }
                                    #endregion

                                    #region COT4DD
                                    string str4 = item2.COT4DD;
                                    string[] arrListStr4 = str4.Split(';');
                                    int R4 = Convert.ToInt32(arrListStr4[0]);
                                    int G4 = Convert.ToInt32(arrListStr4[1]);
                                    int B4 = Convert.ToInt32(arrListStr4[2]);

                                    string fontchu4 = arrListStr4[3];
                                    string sizechu4 = arrListStr4[4];

                                    string indam4 = "normal";
                                    string nghien4 = "normal";
                                    string cangiua4 = "normal";

                                    if (arrListStr4[5] == "T")
                                    {
                                        indam4 = "bold";
                                    }

                                    if (arrListStr4[6] == "T")
                                    {
                                        nghien4 = "italic";
                                    }
                                    if (arrListStr4[7] == "T")
                                    {
                                        cangiua4 = "center";
                                    }
                                    #endregion

                                    #region COT5DD
                                    string str5 = item2.COT5DD;
                                    string[] arrListStr5 = str5.Split(';');
                                    int R5 = Convert.ToInt32(arrListStr5[0]);
                                    int G5 = Convert.ToInt32(arrListStr5[1]);
                                    int B5 = Convert.ToInt32(arrListStr5[2]);

                                    string fontchu5 = arrListStr5[3];
                                    string sizechu5 = arrListStr5[4];

                                    string indam5 = "normal";
                                    string nghien5 = "normal";
                                    string cangiua5 = "normal";

                                    if (arrListStr5[5] == "T")
                                    {
                                        indam5 = "bold";
                                    }

                                    if (arrListStr5[6] == "T")
                                    {
                                        nghien5 = "italic";
                                    }
                                    if (arrListStr5[7] == "T")
                                    {
                                        cangiua5 = "center";
                                    }
                                    #endregion

                                    #region COT6DD
                                    string str6 = item2.COT6DD;
                                    string[] arrListStr6 = str6.Split(';');
                                    int R6 = Convert.ToInt32(arrListStr6[0]);
                                    int G6 = Convert.ToInt32(arrListStr6[1]);
                                    int B6 = Convert.ToInt32(arrListStr6[2]);

                                    string fontchu6 = arrListStr6[3];
                                    string sizechu6 = arrListStr6[4];

                                    string indam6 = "normal";
                                    string nghien6 = "normal";
                                    string cangiua6 = "normal";

                                    if (arrListStr6[5] == "T")
                                    {
                                        indam6 = "bold";
                                    }

                                    if (arrListStr6[6] == "T")
                                    {
                                        nghien6 = "italic";
                                    }
                                    if (arrListStr6[7] == "T")
                                    {
                                        cangiua6 = "center";
                                    }
                                    #endregion

                                    #region COT7DD
                                    string str7 = item2.COT7DD;
                                    string[] arrListStr7 = str7.Split(';');
                                    int R7 = Convert.ToInt32(arrListStr7[0]);
                                    int G7 = Convert.ToInt32(arrListStr7[1]);
                                    int B7 = Convert.ToInt32(arrListStr7[2]);

                                    string fontchu7 = arrListStr7[3];
                                    string sizechu7 = arrListStr7[4];

                                    string indam7 = "normal";
                                    string nghien7 = "normal";
                                    string cangiua7 = "normal";

                                    if (arrListStr7[5] == "T")
                                    {
                                        indam7 = "bold";
                                    }

                                    if (arrListStr7[6] == "T")
                                    {
                                        nghien7 = "italic";
                                    }
                                    if (arrListStr7[7] == "T")
                                    {
                                        cangiua7 = "center";
                                    }
                                    #endregion

                                    #region COT8DD
                                    string str8 = item2.COT8DD;
                                    string[] arrListStr8 = str8.Split(';');
                                    int R8 = Convert.ToInt32(arrListStr8[0]);
                                    int G8 = Convert.ToInt32(arrListStr8[1]);
                                    int B8 = Convert.ToInt32(arrListStr8[2]);

                                    string fontchu8 = arrListStr8[3];
                                    string sizechu8 = arrListStr8[4];

                                    string indam8 = "normal";
                                    string nghien8 = "normal";
                                    string cangiua8 = "normal";

                                    if (arrListStr8[5] == "T")
                                    {
                                        indam8 = "bold";
                                    }

                                    if (arrListStr8[6] == "T")
                                    {
                                        nghien8 = "italic";
                                    }
                                    if (arrListStr8[7] == "T")
                                    {
                                        cangiua8 = "center";
                                    }
                                    #endregion

                                }
                                <table class="table" style="table-layout: fixed; border-top: hidden; width: 100%; height: 5vh; background-color: rgb( @RMN, @GMN, @BMN )">
                                    <tbody>
                                        <tr>
                                            <td colspan="2" style="padding:3px;border:hidden">
                                                <div>
                                                    <label style="display:block;font-family:@fontchu;font-size:@sizechu;font-weight:@indam; font-style:@nghien;text-align:@cangiua;color:rgb(@R1,@G1,@B1)">@item2.COT1 </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <label style="margin-top: -9.5px; display: block; font-family: @fontchu2; font-size: @sizechu2; font-weight: @indam2; font-style: @nghien2; text-align: @cangiua2; color: rgb( @R2, @G2, @B2 )"> @item2.COT2</label>
                                                </div>

                                                <div>
                                                    <label style="margin-top: -9.5px; display: block; font-family: @fontchu4; font-size: @sizechu4; font-weight: @indam4; font-style: @nghien4; text-align: @cangiua4; color: rgb( @R4, @G4, @B4 )">@item2.COT4</label>
                                                </div>
                                            </td>
                                            <td>
                                                <div>
                                                    <label style="margin-top: -9.5px; display: block; font-family: @fontchu3; font-size: @sizechu3; font-weight: @indam3; font-style: @nghien3; text-align: @cangiua3; color: rgb( @R3, @G3, @B3 )">@item2.COT3</label>
                                                </div>
                                                <div>
                                                    <label style="margin-top: -9.5px; display: block; font-family: @fontchu5; font-size: @sizechu5; font-weight: @indam5; font-style: @nghien5; text-align: @cangiua5; color: rgb( @R5, @G5, @B5 )">@item2.COT5</label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr></tr>
                                    </tbody>
                                </table>
                            </div>
                        }
                    </td>
                </tr>
            </table>
        </body>}
    catch (Exception)
    { }
    break;
}

<script>
    $(document).ready(function () {
        $.getJSON("../Home/getData", function (data) {
            var cot1 = []
            var cot9bd = []
            var cot10bd = []
            var maubd = []
            var dncot9 = []
            var dncot10 = []
            for (var i = 0; i < data.length; i++) {
                cot1.push(data[i].name);
                cot9bd.push(data[i].count);
                cot10bd.push(data[i].text);
                maubd.push(data[i].color);
            }
            for (var i = 0; i < data.length; i++) {
                dncot9.push(data[i].namedn9);
                dncot10.push(data[i].namedn10);
                break;
            }
            Highcharts.setOptions({
                colors: maubd
            });
            Highcharts.chart('container', {
                chart: {
                    type: 'bar'
                },
                xAxis: {
                    categories: cot1,
                    min: 0
                },
                yAxis: {
                    min: 0,
                },
                legend: {
                    reversed: true
                },
                plotOptions: {
                    series: {
                        stacking: 'normal'
                    },
                    bar: {
                        colorByPoint: true
                    }

                },
                series: [{
                    name: dncot9,
                    data: cot9bd,

                    borderColor: 'rgb(0,128,255)'
                },
                {
                    name: dncot10,
                    type: 'spline',
                    data: cot10bd,
                    color: 'rgb(0,128,255)'
                }]
            });
        });
    });
</script>

<script>
    function startTime() {
        const today = new Date();
        let h = today.getHours();
        let m = today.getMinutes();
        let s = today.getSeconds();
        m = checkTime(m);
        s = checkTime(s);
        document.getElementById('gioht').innerHTML = h + ":" + m + ":" + s;
        setTimeout(startTime, 1000);
    }
    function checkTime(i) {
        if (i < 10) { i = "0" + i };  // add zero in front of numbers < 10
        return i;
    }
</script>
